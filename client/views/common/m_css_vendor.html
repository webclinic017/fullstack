<script>
    (function (doc, win) {
        //设计图的宽度
        var viewBase = 750;
        var fontBase = 32; //css文件中font-base ，基于该值计算rem值
        var docEl = doc.documentElement,
            resizeEvt = 'orientationchange' in window ? 'orientationchange' : 'resize',
            recalc = function () {
                var clientWidth = docEl.clientWidth;
                if (!clientWidth) {
                    return;
                }
                docEl.style.fontSize = fontBase * (clientWidth / viewBase) + 'px';
            };
        recalc();
        if (!doc.addEventListener) {
            return;
        }
        win.addEventListener(resizeEvt, recalc, false);
        doc.addEventListener('DOMContentLoaded', recalc, false);
    })(document, window);


    //native和h5通讯
    function callNative(oAction) {
        var sAction = JSON.stringify(oAction);
        //IOS和Android均会在页面写入该对象。只是调用方法略不同
        if (isIOS()) {
            TigerwitNative(sAction);
        } else {
            TigerwitNative.jsCall(sAction);
        }
        return true;
    }

    /*判断是否在APP中*/
    function isInTiger() {
        var userPlatForm = window.navigator.userAgent;
        var flag = userPlatForm.indexOf("tigerwit_app");
        if (flag >= 0) {
            return true;
        } else {
            return false;
        }
    }

    function isAndriod() {
        var bIsAndroid = navigator.userAgent.toLowerCase().match(/android/i) == "android";
        return bIsAndroid;
    }

    function getVersionName() {
        var userAgent = window.navigator.userAgent;
        var targetStr = 'tiger_version=';
        if (userAgent.indexOf(targetStr) != -1) {
            return userAgent.substr(userAgent.indexOf(targetStr) + targetStr.length, 5);
        }
    }

    function isIOS() {
        return /like Mac OS X/.test(navigator.userAgent);
    }

    /*
     判断是否在tigerwit公司
     */
    function isTigerCo() {
        if ($.cookie('company_name') == 'tigerwit') {
            return true;
        } else {
            return false;
        }
    }

    /**
     * 兼容安卓页面下拉刷新问题
     * */
    function offsetAction(index) {
        /*debug*/
        if (!isIOS() && isInTiger()) {
            callNative({
                type: 'offset',
                offset: index - 1
            })
        }
    }

    /*
        获取高度
    */
    function getClientHeight() {
        return (document.body.clientHeight || document.documentElement.clientHeight);
    }

    /**
     * [isMobile 判断平台]
     * @param test: 0:iPhone    1:Android
     */
    function ismobile(test) {
        var u = navigator.userAgent, app = navigator.appVersion;
        if (/AppleWebKit.*Mobile/i.test(navigator.userAgent) || (/MIDP|SymbianOS|NOKIA|SAMSUNG|LG|NEC|TCL|Alcatel|BIRD|DBTEL|Dopod|PHILIPS|HAIER|LENOVO|MOT-|Nokia|SonyEricsson|SIE-|Amoi|ZTE/.test(navigator.userAgent))) {
            if (window.location.href.indexOf("?mobile") < 0) {
                try {
                    if (/iPhone|mac|iPod|iPad/i.test(navigator.userAgent)) {
                        return '0';
                    } else {
                        return '1';
                    }
                } catch (e) {
                }
            }
        } else if (u.indexOf('iPad') > -1) {
            return '0';
        } else {
            return '1';
        }
    };

    function debugAndroidKey(conf) {
        if (!isIOS() || isAndriod()) {
            // 移除resize 事件
            $(window).on('resize', function () {
                var cvs = document.createElement('canvas');
                cvs.width = 0;
                cvs.height = 0;
                document.appendChild(cvs);
            });

            var focusFlag = false;
            var $element = $(conf.focusSelector);
            var $reg_box = $(conf.ctrlBox);
            var initClientHeight = getClientHeight();
            var focusClientHeight = null;

            $element.focus(function () {
                focusFlag = true;
                focusClientHeight = getClientHeight();
                $reg_box.css(conf.focusCss);
                $.isFunction(conf.focusFn) && conf.focusFn();
            });

            $element.blur(function () {
                focusFlag = false;
                $reg_box.css(conf.blurCss);
                $.isFunction(conf.blurFn) && conf.blurFn();
            });

            window.addEventListener('resize', function () {
                // console.log(getClientHeight());
                setTimeout(function () {
                    if (getClientHeight() == focusClientHeight) {
                        $reg_box.css(conf.blurCss);
                    } else {
                        $reg_box.css(conf.focusCss);
                    }
                }, 10);
            })
        }
    }
</script>