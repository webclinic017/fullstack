<script>
    //声明_czc对象:
    var _czc = _czc || [];
    //绑定siteid
    _czc.push(["_setAccount", "1260394016"]);
</script>
<script>
    // function getCookie(name) {
    //     var arr, reg = new RegExp("(^| )" + name + "=([^;]*)(;|$)");
    //     if (arr = document.cookie.match(reg)) {
    //         return unescape(arr[2]);
    //     }
    //     else {
    //         return null;
    //     }
    // }
    function setCookie({ name, value, expires, domain, path, secure }) {
        path = path || '/';
        expires = expires || 30;
        domain = domain || getDomain();
        var cookieText = "";
        cookieText += encodeURIComponent(name) + "=" + encodeURIComponent(value);

        // expires
        var oDate = new Date();
        oDate.setTime(oDate.getTime() + (expires * 24 * 60 * 60 * 1000));
        cookieText += "; expires=" + oDate.toGMTString();

        // path
        cookieText += "; path=" + path;
        cookieText += "; domain=" + domain;
        if (secure) {
            cookieText += "; secure";
        }
        document.cookie = cookieText;
    }
    // 获取cookies
    function getCookie(name) {
        var cookieName = encodeURIComponent(name) + "=",
            cookieStart = document.cookie.indexOf(cookieName),
            cookieValue = "";
        if (cookieStart > -1) {
            var cookieEnd = document.cookie.indexOf(";", cookieStart);
            if (cookieEnd == -1) {
                cookieEnd = document.cookie.length;
            }
            cookieValue = decodeURIComponent(document.cookie.substring(cookieStart + cookieName.length, cookieEnd));
        }
        return cookieValue;
    }
    // 删除cookie
    function delCookie({ name, domain, path, secure }) {
        var value = '';
        var expires = Date(0)
        setCookie({ name, value, expires, domain, path, secure });
    }

    // 截取域名
    function getDomain() {
        var domain;
        if (location.hostname === 'localhost') {
            domain = 'localhost';
        } else {
            domain = '.' + location.hostname.split('.').slice(-2).join('.');
        }
        // console.log(url.match(/\.\w+\.com/)[0]);
        return domain;
    }
    // var allowPath = [
    //     'global.tigerwit.com',
    //     'cn.tigerwit.com',
    //     'bd.tigerwitfx.com'
    // ]; // cn无用需删
    var allowStatus = false;
    // for (var i=0;i<allowPath.length;i++) {
    //     if (window.location.href.indexOf(allowPath[i]) != -1) {
    //         allowStatus = true;
    //     }
    // }
    if (allowStatus) {
        // (弃)
        (function (para) {
            var p = para.sdk_url, n = para.name, w = window, d = document, s = 'script', x = null, y = null;
            w['sensorsDataAnalytic201505'] = n;
            w[n] = w[n] || function (a) { return function () { (w[n]._q = w[n]._q || []).push([a, arguments]); } };
            var ifs = ['track', 'quick', 'register', 'registerPage', 'registerOnce', 'clearAllRegister', 'trackSignup', 'trackAbtest', 'setProfile', 'setOnceProfile', 'appendProfile', 'incrementProfile', 'deleteProfile', 'unsetProfile', 'identify', 'login', 'logout', 'trackLink', 'clearAllRegister', 'getAppStatus'];
            for (var i = 0; i < ifs.length; i++) {
                w[n][ifs[i]] = w[n].call(null, ifs[i]);
            }
            if (!w[n]._t) {
                x = d.createElement(s), y = d.getElementsByTagName(s)[0];
                x.async = 1;
                x.src = p;
                y.parentNode.insertBefore(x, y);
                w[n].para = para;
            }
        })({
            sdk_url: '/plugins/sa-sdk-javascript-1.11.2/sensorsdata.min.js',
            heatmap_url: '/plugins/sa-sdk-javascript-1.11.2/heatmap.min.js',
            name: 'sa',
            // H5与APP打通
            use_app_track: true,
            web_url: 'https://admin-shence.tigerwit.com:8887/',
            server_url: 'https://shence.tigerwit.com:8006/sa',
            heatmap: {
                //是否开启点击图，默认 default 表示开启，可以设置 'not_collect' 表示关闭
                clickmap: 'default',
                //是否开启触达注意力图，默认 default 表示开启，可以设置 'not_collect' 表示关闭
                scroll_notice_map: 'default',
                //设置成 true 后，我们会自动给 a 标签绑定一个 sa.trackLink() 方法（详见本页 3.3 ）。
                //如果是单页面 a 标签不涉及页面跳转或者 a 标签的点击是下载功能，建议不要打开。默认 false 。
                isTrackLink: false,
                //设置多少毫秒后开始渲染点击图,因为刚打开页面时候页面有些元素还没加载
                loadTimeout: 3000,
                //返回真会采集当前页面的数据，返回假表示不采集当前页面,设置这个函数后，内容为空的话，是返回假的。不设置函数默认是采集所有页面
                collect_url: function () {
                    return true;
                },
                //用户点击（a，button，input）这些元素时会触发这个函数，让你来判断是否要采集当前这个元素，返回真表示采集，返回假表示不采集。
                //不设置这个函数，默认是采集 a button input 这些标签。
                collect_element: function (element_target) {
                    return true;
                },
                //考虑到用户隐私，这里可以设置input里的内容是否采集
                //如果返回真，表示采集input内容，返回假表示不采集input内容,默认不采集    
                collect_input: function (element_target) {
                    return false;
                },
                //假如要在 $WebClick 事件增加自定义属性，可以通过（a，button，input）这三类标签的特征来判断是否要增加
                custom_property: function (element_target) {

                },
                // 设置触达图的有效停留时间，默认超过4秒以上算有效停留
                scroll_delay_time: 3000
            }
        });
        var user_id = getCookie('user_code');
        // console.log(sa.track);
        if (user_id) {  //此处user_id为tigerwit的用户id ,可在拿到后再调用
            sa.login(user_id);  //参数必须是字符串，且必须有值 
        }
        sa.quick('autoTrack'); //神策系统必须是1.4最新版及以上
    } else {
        (function (w) {
            var ifs = ['track', 'quick', 'register', 'registerPage', 'registerOnce', 'clearAllRegister', 'trackSignup', 'trackAbtest', 'setProfile', 'setOnceProfile', 'appendProfile', 'incrementProfile', 'deleteProfile', 'unsetProfile', 'identify', 'login', 'logout', 'trackLink', 'clearAllRegister', 'getAppStatus'];
            w.sa = {};
            for (var i = 0; i < ifs.length; i++) {
                // console.info(ifs[i]);
                w["sa"][ifs[i]] = publicFunc;
            }
            function publicFunc(param) {
                // 只有tigerwit计算到神策统计中
                // console.info("not tiger", param);
            }
        })(window);
    }
</script>
<script>
    function getSoleID(length) {
        return Number(Math.random().toString().substr(3, length) + Date.now()).toString(36);
    }
    /**
     * 设置浏览器id
     * bol  重新设置
    */
    setBrowserID(); // 初始化执行一次
    function setBrowserID(bol) {
        if (bol || !getCookie('BROWSER_ID')) {
            setCookie({ name: 'BROWSER_ID', value: getSoleID(), expires: 365 });
        }
    }
    /**
    * 发送事件
    * eventName  事件
    * obj  其他参数
   */
    function sendEvent(eventName, obj) {
        // 埋点事件，不需要处理
        $.ajax({
            type: "POST",
            url: "/api/v3/appsflyer/event/add",
            data: Object.assign({ browser_id: getCookie('BROWSER_ID'), event_name: eventName }, obj),
            dataType: "json"
        })
    }

    // 避免掉不必要的try catch
    function setGtagUserId(userId) {
        setBrowserID(true);
        console.log('国内不需要google Analytics统计', userId)
    }

    function toGtagEvent(action, obj) {
        sendEvent(action, obj)
        console.log('国内不需要google Analytics统计')
        console.log('国内不需要facebook统计')
    };
</script>
<%if (lang.areaId != 1) {%>
<!-- Facebook Pixel Code -->
<script>
    !function (f, b, e, v, n, t, s) {
        if (f.fbq) return; n = f.fbq = function () {
            n.callMethod ?
                n.callMethod.apply(n, arguments) : n.queue.push(arguments)
        };
        if (!f._fbq) f._fbq = n; n.push = n; n.loaded = !0; n.version = '2.0';
        n.queue = []; t = b.createElement(e); t.async = !0;
        t.src = v; s = b.getElementsByTagName(e)[0];
        s.parentNode.insertBefore(t, s)
    }(window, document, 'script',
        'https://connect.facebook.net/en_US/fbevents.js');
    fbq('init', '246588836047542');
    fbq('track', 'PageView');
</script>
<noscript><img height="1" width="1" style="display:none"
        src="https://www.facebook.com/tr?id=246588836047542&ev=PageView&noscript=1" /></noscript>
<!-- End Facebook Pixel Code -->
<!-- 2019.01.03 -->
<!-- Facebook Pixel Code-->
<script>
    fbq('init', '2082695268476120');
    fbq('track', 'PageView');
</script>
<noscript><img height="1" width="1" style="display:none"
        src="https://www.facebook.com/tr?id=2082695268476120&ev=PageView&noscript=1" /></noscript>
<!-- End Facebook Pixel Code -->
<!--here is the tracking code for the global website, we need to make sure this is implemented across every page.-->
<!-- Global site tag (gtag.js) - Google Analytics - added at 2019.06.28 -->
<!-- 接口文档 https://developers.google.com/analytics/devguides/collection/gtagjs/events -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-142852435-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    // 设置用户名
    function setGtagUserId(userId, init) {
        if (!init) {
            setBrowserID(true);
        }
        gtag('config', 'UA-142852435-1', {
            'user_id': userId
        });
    }
    var user_id = getCookie('user_code');
    if (user_id) {
        setGtagUserId(user_id, true)
    } else {
        // 谷歌埋点
        gtag('config', 'UA-142852435-1');
    }
    // google Ads再营销代码
    gtag('config', 'AW-750596788');
    // 传递事件
    function toGtagEvent(action, obj) {
        sendEvent(action, obj)
        if (obj && obj.belong == 'tigerwit') {
            return
        }
        gtag('event', action, {
            'event_category': 'action',
            'event_label': 'catalogory'
        });
        // goog_report_conversion(action)

        // Add this to a button's onclick handler
        // FB.AppEvents.logEvent(action);
        fbq('trackCustom', action)
    };
</script>
<!-- facebook事件埋点 https://developers.facebook.com/docs/app-events/getting-started-app-events-web -->
<!-- <script>
  window.fbAsyncInit = function() {
    FB.init({
      appId      : '2496083880613464',
      xfbml      : true,
      version    : 'v4.0'
    });
    FB.AppEvents.logPageView();
  };
</script>
<script async defer 
  src="https://connect.facebook.net/en_US/sdk.js">
</script> -->
<%}%>