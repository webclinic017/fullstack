<script>
    //声明_czc对象:
    var _czc = _czc || [];
    //绑定siteid
    _czc.push(["_setAccount", "1260394016"]);
</script>
<script>
    // function getCookie(name) {
    //     var arr, reg = new RegExp("(^| )" + name + "=([^;]*)(;|$)");
    //     if (arr = document.cookie.match(reg)) {
    //         return unescape(arr[2]);
    //     }
    //     else {
    //         return null;
    //     }
    // }
    function setCookie({ name, value, expires, domain, path, secure }) {
        path = path || '/';
        expires = expires || 30;
        domain = domain || getDomain();
        var cookieText = "";
        cookieText += encodeURIComponent(name) + "=" + encodeURIComponent(value);

        // expires
        var oDate = new Date();
        oDate.setTime(oDate.getTime() + (expires * 24 * 60 * 60 * 1000));
        cookieText += "; expires=" + oDate.toGMTString();

        // path
        cookieText += "; path=" + path;
        cookieText += "; domain=" + domain;
        if (secure) {
            cookieText += "; secure";
        }
        document.cookie = cookieText;
    }
    // 获取cookies
    function getCookie(name) {
        var cookieName = encodeURIComponent(name) + "=",
            cookieStart = document.cookie.indexOf(cookieName),
            cookieValue = "";
        if (cookieStart > -1) {
            var cookieEnd = document.cookie.indexOf(";", cookieStart);
            if (cookieEnd == -1) {
                cookieEnd = document.cookie.length;
            }
            cookieValue = decodeURIComponent(document.cookie.substring(cookieStart + cookieName.length, cookieEnd));
        }
        return cookieValue;
    }
    // 删除cookie
    function delCookie({ name, domain, path, secure }) {
        var value = '';
        var expires = Date(0)
        setCookie({ name, value, expires, domain, path, secure });
    }

    // 截取域名
    function getDomain() {
        var domain;
        if (location.hostname === 'localhost') {
            domain = 'localhost';
        } else {
            domain = '.' + location.hostname.split('.').slice(-2).join('.');
        }
        // console.log(url.match(/\.\w+\.com/)[0]);
        return domain;
    }
    // 神策统计已下线，这里保持事件，兼容未清理的统计代码
    (function (w) {
        var ifs = ['track', 'quick', 'register', 'registerPage', 'registerOnce', 'clearAllRegister', 'trackSignup', 'trackAbtest', 'setProfile', 'setOnceProfile', 'appendProfile', 'incrementProfile', 'deleteProfile', 'unsetProfile', 'identify', 'login', 'logout', 'trackLink', 'clearAllRegister', 'getAppStatus'];
        w.sa = {};
        for (var i = 0; i < ifs.length; i++) {
            // console.info(ifs[i]);
            w["sa"][ifs[i]] = publicFunc;
        }
        function publicFunc(param) {
            // 只有tigerwit计算到神策统计中
            // console.info("not tiger", param);
        }
    })(window);
</script>
<script>
    function getSoleID(length) {
        return Number(Math.random().toString().substr(3, length) + Date.now()).toString(36);
    }
    /**
     * 设置浏览器id
     * bol  重新设置
    */
    setBrowserID(); // 初始化执行一次
    function setBrowserID(bol) {
        if (bol || !getCookie('BROWSER_ID')) {
            setCookie({ name: 'BROWSER_ID', value: getSoleID(), expires: 365 });
        }
    }
    /**
    * 发送事件
    * eventName  事件
    * obj  其他参数
   */
    function sendEvent(eventName, obj) {
        // 埋点事件，不需要处理
        $.ajax({
            type: "POST",
            url: "/api/v3/appsflyer/event/add",
            data: Object.assign({ browser_id: getCookie('BROWSER_ID'), event_name: eventName }, obj),
            dataType: "json"
        })
    }

    // 避免掉不必要的try catch
    function setGtagUserId(userId) {
        setBrowserID(true);
        console.log('国内不需要google Analytics统计', userId)
    }

    function toGtagEvent(action, obj) {
        sendEvent(action, obj)
        console.log('国内不需要google Analytics统计')
        console.log('国内不需要facebook统计')
    };
</script>
<%if (lang.areaId != 1) {%>
<!-- Facebook Pixel Code -->
<script>
    !function (f, b, e, v, n, t, s) {
        if (f.fbq) return; n = f.fbq = function () {
            n.callMethod ?
                n.callMethod.apply(n, arguments) : n.queue.push(arguments)
        };
        if (!f._fbq) f._fbq = n; n.push = n; n.loaded = !0; n.version = '2.0';
        n.queue = []; t = b.createElement(e); t.async = !0;
        t.src = v; s = b.getElementsByTagName(e)[0];
        s.parentNode.insertBefore(t, s)
    }(window, document, 'script',
        'https://connect.facebook.net/en_US/fbevents.js');
    fbq('init', '246588836047542');
    fbq('track', 'PageView');
</script>
<noscript><img height="1" width="1" style="display:none"
        src="https://www.facebook.com/tr?id=246588836047542&ev=PageView&noscript=1" /></noscript>
<!-- End Facebook Pixel Code -->
<!-- 2019.01.03 -->
<!-- Facebook Pixel Code-->
<script>
    fbq('init', '2082695268476120');
    fbq('track', 'PageView');
</script>
<noscript><img height="1" width="1" style="display:none"
        src="https://www.facebook.com/tr?id=2082695268476120&ev=PageView&noscript=1" /></noscript>
<!-- End Facebook Pixel Code -->
<!--here is the tracking code for the global website, we need to make sure this is implemented across every page.-->
<!-- Global site tag (gtag.js) - Google Analytics - added at 2019.06.28 -->
<!-- 接口文档 https://developers.google.com/analytics/devguides/collection/gtagjs/events -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-142852435-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    // 设置用户名
    function setGtagUserId(userId, init) {
        if (!init) {
            setBrowserID(true);
        }
        gtag('config', 'UA-142852435-1', {
            'user_id': userId
        });
    }
    var user_id = getCookie('user_code');
    if (user_id) {
        setGtagUserId(user_id, true)
    } else {
        // 谷歌埋点
        gtag('config', 'UA-142852435-1');
    }
    // google Ads再营销代码
    gtag('config', 'AW-750596788');
    // 传递事件
    function toGtagEvent(action, obj) {
        sendEvent(action, obj)
        if (obj && obj.belong == 'tigerwit') {
            return
        }
        gtag('event', action, {
            'event_category': 'action',
            'event_label': 'catalogory'
        });
        // goog_report_conversion(action)

        // Add this to a button's onclick handler
        // FB.AppEvents.logEvent(action);
        fbq('trackCustom', action)
    };
</script>
<!-- facebook事件埋点 https://developers.facebook.com/docs/app-events/getting-started-app-events-web -->
<!-- <script>
  window.fbAsyncInit = function() {
    FB.init({
      appId      : '2496083880613464',
      xfbml      : true,
      version    : 'v4.0'
    });
    FB.AppEvents.logPageView();
  };
</script>
<script async defer 
  src="https://connect.facebook.net/en_US/sdk.js">
</script> -->
<%}%>